<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI知识管理系统 - 面试项目演示</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px; 
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { 
            background: rgba(255, 255, 255, 0.95); padding: 30px; 
            border-radius: 15px; margin-bottom: 20px; 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); 
        }
        .header h1 { color: #333; margin-bottom: 10px; font-size: 2.5em; }
        .header p { color: #666; font-size: 1.1em; }
        .dashboard { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; margin-bottom: 20px; 
        }
        .card { 
            background: rgba(255, 255, 255, 0.95); padding: 25px; border-radius: 15px; 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); 
        }
        .card h3 { 
            color: #333; margin-bottom: 15px; font-size: 1.3em; 
            border-bottom: 2px solid #667eea; padding-bottom: 8px; 
        }
        .btn {
            padding: 12px 24px; background: #667eea; color: white; 
            border: none; border-radius: 8px; font-size: 1em; cursor: pointer; 
            transition: background 0.3s;
        }
        .btn:hover { background: #5a6fd8; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .loading { text-align: center; padding: 20px; color: #666; }
        .success { color: #4CAF50; padding: 10px; background: rgba(76, 175, 80, 0.1); border-radius: 5px; margin-top: 10px; }
        .error { color: #f44336; padding: 10px; background: rgba(244, 67, 54, 0.1); border-radius: 5px; margin-top: 10px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .form-group input, .form-group textarea { 
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; 
        }
        .form-group textarea { height: 100px; resize: vertical; }
        .status-item { display: flex; align-items: center; margin-bottom: 8px; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; margin-right: 10px; }
        .status-online { background: #4CAF50; }
        .status-offline { background: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧠 AI知识管理系统</h1>
            <p>全栈AI项目演示 - 适用于AI软件工程师面试</p>
            <p><small>技术栈: Flask + SQLAlchemy + MySQL + Redis + AI算法 + Vue.js前端</small></p>
        </div>
        
        <div class="dashboard">
            <!-- 系统状态卡片 -->
            <div class="card">
                <h3>📊 系统状态</h3>
                <div id="systemStatus">
                    <div class="loading">加载系统状态...</div>
                </div>
            </div>
            
            <!-- AI分类演示卡片 -->
            <div class="card">
                <h3>🤖 AI智能分类</h3>
                <div class="form-group">
                    <label for="testTitle">标题:</label>
                    <input type="text" id="testTitle" placeholder="输入文档标题">
                </div>
                <div class="form-group">
                    <label for="testContent">内容:</label>
                    <textarea id="testContent" placeholder="输入文档内容进行AI分类测试..."></textarea>
                </div>
                <button class="btn" onclick="testAIClassification()">测试AI分类</button>
                <div id="classificationResult" style="margin-top: 15px;"></div>
            </div>
            
            <!-- 创建文档卡片 -->
            <div class="card">
                <h3>📝 创建文档</h3>
                <form id="documentForm">
                    <div class="form-group">
                        <label for="docTitle">标题:</label>
                        <input type="text" id="docTitle" placeholder="输入文档标题" required>
                    </div>
                    <div class="form-group">
                        <label for="docContent">内容:</label>
                        <textarea id="docContent" placeholder="输入文档内容" required></textarea>
                    </div>
                    <button type="submit" class="btn" id="submitBtn">🚀 创建并AI处理</button>
                </form>
                <div id="formResult"></div>
            </div>
        </div>
        
        <!-- 项目亮点展示 -->
        <div class="card">
            <h3>🎯 项目技术亮点</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                <div>
                    <h4>🏗️ 系统架构</h4>
                    <ul style="color: #666; line-height: 1.6;">
                        <li>Flask + SQLAlchemy ORM</li>
                        <li>MySQL + Redis 缓存</li>
                        <li>模块化AI服务设计</li>
                        <li>RESTful API 设计</li>
                    </ul>
                </div>
                <div>
                    <h4>🤖 AI能力</h4>
                    <ul style="color: #666; line-height: 1.6;">
                        <li>多算法融合分类</li>
                        <li>智能标签生成</li>
                        <li>语义搜索</li>
                        <li>内容推荐</li>
                    </ul>
                </div>
                <div>
                    <h4>🔧 工程化</h4>
                    <ul style="color: #666; line-height: 1.6;">
                        <li>错误处理与降级</li>
                        <li>性能监控</li>
                        <li>缓存策略</li>
                        <li>API文档</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API基础URL
        const API_BASE = '/api/ai';
        
        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadSystemStatus();
            
            // 文档表单提交
            document.getElementById('documentForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                await createDocumentWithAI();
            });
        });
        
        // 加载系统状态
        async function loadSystemStatus() {
            try {
                const response = await fetch('/api/ai/health');
                const data = await response.json();
                
                let statusHtml = '';
                if (data.overall_status === 'healthy') {
                    statusHtml += '<div class="success">✅ 所有AI服务运行正常</div>';
                    statusHtml += '<div style="margin-top: 15px;">';
                    for (const [service, info] of Object.entries(data.services)) {
                        statusHtml += `<div class="status-item">
                            <div class="status-dot status-online"></div>
                            <div>${info.service}: ${info.initialized ? '运行中' : '未初始化'}</div>
                        </div>`;
                    }
                    statusHtml += '</div>';
                } else {
                    statusHtml = '<div class="error">❌ AI服务异常</div>';
                }
                
                document.getElementById('systemStatus').innerHTML = statusHtml;
                
            } catch (error) {
                document.getElementById('systemStatus').innerHTML = 
                    '<div class="error">加载状态失败: ' + error.message + '</div>';
            }
        }
        
        // 测试AI分类
        async function testAIClassification() {
            const title = document.getElementById('testTitle').value;
            const content = document.getElementById('testContent').value;
            const resultDiv = document.getElementById('classificationResult');
            
            if (!content) {
                resultDiv.innerHTML = '<div class="error">请输入内容进行测试</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="loading">AI正在分析文本...</div>';
            
            try {
                const response = await fetch(API_BASE + '/documents/classify-text', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        title: title || '测试文档',
                        text: content 
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const classification = data.classification;
                    resultDiv.innerHTML = `
                        <div class="success">
                            <strong>AI分类结果:</strong><br>
                            分类: ${classification.category_name || '未知'} (ID: ${classification.category_id})<br>
                            置信度: ${(classification.confidence * 100).toFixed(1)}%<br>
                            方法: ${classification.method}<br>
                            耗时: ${classification.processing_time}s
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = '<div class="error">分类失败: ' + (data.error || '未知错误') + '</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">请求失败: ' + error.message + '</div>';
            }
        }
        
        // 创建文档
        async function createDocumentWithAI() {
            const title = document.getElementById('docTitle').value;
            const content = document.getElementById('docContent').value;
            const submitBtn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('formResult');
            
            if (!title || !content) {
                resultDiv.innerHTML = '<div class="error">请填写标题和内容</div>';
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = '处理中...';
            resultDiv.innerHTML = '<div class="loading">AI正在处理文档...</div>';
            
            try {
                const response = await fetch(API_BASE + '/documents', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title, content })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            ✅ 文档创建成功!<br>
                            文档ID: ${data.document_id}<br>
                            AI分类方法: ${data.ai_processing.category_prediction.method}<br>
                            置信度: ${(data.ai_processing.category_prediction.confidence * 100).toFixed(1)}%
                        </div>
                    `;
                    document.getElementById('documentForm').reset();
                } else {
                    resultDiv.innerHTML = '<div class="error">创建失败: ' + (data.error || '未知错误') + '</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">请求失败: ' + error.message + '</div>';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '🚀 创建并AI处理';
            }
        }
        
        // 演示用例
        function loadDemoContent() {
            document.getElementById('testTitle').value = '机器学习项目总结';
            document.getElementById('testContent').value = '今天完成了机器学习项目的特征工程和模型训练，使用了随机森林和XGBoost算法，在测试集上达到了85%的准确率。下一步计划进行模型优化和部署。';
        }
        
        // 页面加载后加载演示内容
        setTimeout(loadDemoContent, 1000);
    </script>
</body>
</html>
